# Adding a new page for logged-in buyers #

Logged in buyers are basically buyers who have an account on the marketplace. This means that mere visitors will not see the page created by this plug in: 

The first step is to create the new page in HTML. One important thing to know before starting to write the page is that if an empty html file is saved in the user/html folder, the page, when accessed, will not empty. 
Instead it will look like this: 

<p align="center">
  <img src="https://drive.google.com/uc?id=1T3Pj-mdCo90ug7An5pRpRpB3pG6AUz0m"/>
</p>

What you are looking at right now is the marketplace’s header, footer, and nothing in between.

## Adding a page for all logged-in buyers, accessible from all pages ##
* The only restriction we have for this section is making that page accessible from a logged-in
buyer’s portal only. We write that restriction in JavaScript using:

```javascript
if($("#merchantId") && $("#merchantId").length){
  return 0;
} 
else {
  if($("#userId") && $("#userId").length){
    //do something
  }
}
```
The reason for returning 0 if merchantId exists is that logged in merchants and logged in buyer both
have a userId. But only logged-in merchants have a merchantId. Logged in buyers have a userId but
no merchantId.

Next, we decide where we want the link for the page to be on the buyer pages. In this example, we
want the link to be on the header. This can be coded like this:

```javascript
var a = document.createElement("a"); 
        a.href = "https://" + hostname + "/user/plugins/" + packageId + "/link.html";
        a.innerHTML = "Link"; 
        a.target = "_blank";

        var b = document.createElement("li");
            b.appendChild(a);

        var c = document.querySelector("ul.navigation");
            c.insertBefore(b, document.querySelector(.dropdown));
```
<p align="center">
  <img src="https://drive.google.com/uc?id=1pwtdMfJkJXC3HKpe_zhwxvOgjgASd2jo"/>
</p>

As can be seen above, the link’s URL points to an html file that was created and saved in the
user/html folder.
* Next, we create the [HTML](https://github.com/Arcadier/Tutorials/blob/master/Adding%20a%20new%20page%20for%20logged%20in%20buyers/user/html/link.html) file and give it a name that is matched on the script. In this
example, we created a file with very random content:
  * A dynamically changing graph which is representing numbers being generated by a
script.
  * A button that affects the look of an element.
  * A button that calls an API, displays the response, and triggers Arcadier’s Toastr
notification.
  * An iframe from an external app (Spotify)
  * A random image with a random button.

This HTML file is saved in the **user/html** folder.
The scripts are all saved in the **user/scripts** folder.

After correctly and successfully uploading all the files on the developer dashboard. Enabling the
package and installing it will result in this:
<p align="center"><img src="https://drive.google.com/uc?id=1BM9tYQCVMil-Leq2vR6BMMfQqSYW9pCU" /></p>

## Adding a page accessible for all logged-in buyers, accessible from all pages, on a specific marketplace type ##

* The additional restriction we have here we have for this section is making that page
accessible from a logged-in buyer’s portal only, for bespoke marketplaces. We write that
restriction in JavaScript using:
```javascript
if($("#merchantId") && $("#merchantId").length){
  return 0;
} 
else {
  if($("#userId") && $("#userId").length){
    if('input').each(function(){
      if($(this).attr('value') == 'bespoke'){
        //do something
      }
    })
  }
}
```
<p align="center">OR (for a spacetime marketplace)</p>

```javascript
if($("#merchantId") && $("#merchantId").length){
  return 0;
} 
else {
  if($("#userId") && $("#userId").length){
    if('input').each(function(){
      if($(this).attr('value') == 'spacetime'){
        //do something
      }
    })
  }
}
```

## Adding a page accessible for all logged-in buyers, accessible from a specific page, on a specific marketplace type ##

* The additional restriction we have here we have for this section is making that page
accessible from a logged-in buyer’s portal only, for bespoke marketplaces, on a specific
page. For example, we want buyers to be able to access the page when they visit the cart
page of their bespoke marketplace. We write that restriction in JavaScript using:
```javascript
if($("#merchantId") && $("#merchantId").length){
  return 0;
} 
else {
  if($("#userId") && $("#userId").length && $('body').hasClass('page-cart')){
    if('input').each(function(){
      if($(this).attr('value') == 'bespoke'){
        //do something
      }
    })
  }
}
```
